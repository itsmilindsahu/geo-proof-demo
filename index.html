<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TRACEWASTE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: auto;
      padding: 20px;
      text-align: center;
    }

    .box {
      border: 1px solid #ccc;
      padding: 15px;
      margin-top: 20px;
      text-align: left;
    }

    input, button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      font-size: 16px;
    }
  </style>
</head>

<body>

  <!-- BASIC HEADER -->
  <h1>TRACEWASTE</h1>
  <p><b>QR-Enabled, Geo-Verified Waste Traceability System</b></p>

  <hr>

  <!-- DEPLOYMENT CHECK -->
  <div class="box">
    <b>Deployment Status</b><br>
    ‚úÖ GitHub Pages is working if you can see this page.
  </div>

  <!-- BATCH CHECK -->
  <div class="box">
    <b>Batch ID from QR</b><br>
    <span id="batchText">No batch detected</span>
  </div>

  <!-- LOCATION -->
  <button onclick="captureLocation()">üìç Capture Geo-Location</button>

  <div class="box" id="locationBox">
    Location not captured
  </div>

  <!-- SUBMIT -->
  <button onclick="submitProof()">‚úÖ Submit Proof</button>

  <div class="box" id="output"></div>

  <script>
    // Read batch from URL
    const params = new URLSearchParams(window.location.search);
    const batch = params.get("batch");

    if (batch) {
      document.getElementById("batchText").innerText = batch;
    }

    let lat = null, lon = null;

    function captureLocation() {
      if (!navigator.geolocation) {
        alert("Geolocation not supported");
        return;
      }

      navigator.geolocation.getCurrentPosition(pos => {
        lat = pos.coords.latitude;
        lon = pos.coords.longitude;
        document.getElementById("locationBox").innerHTML =
          "Latitude: " + lat + "<br>Longitude: " + lon;
      });
    }

    function submitProof() {
      if (!lat || !lon) {
        alert("Capture location first");
        return;
      }

      document.getElementById("output").innerHTML =
        "<b>Proof Submitted</b><br>" +
        "Batch: " + (batch || "N/A") + "<br>" +
        "Time: " + new Date().toISOString();
    }
  </script>

</body>
</html>

